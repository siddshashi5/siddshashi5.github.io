<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Project 3 - Face Morphing</title>
    <style>
        body {
            font-family: 'Helvetica Neue', Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f4f4;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        h1 {
            color: #222;
            text-align: center;
            font-size: 2.5em;
            margin-bottom: 20px;
            font-weight: 300;
        }

        h2 {
            color: #444;
            font-size: 1.8em;
            margin-top: 40px;
            margin-bottom: 15px;
            font-weight: 400;
        }

        p {
            font-size: 1.1em;
            line-height: 1.8;
            margin-bottom: 20px;
        }

        .image-row {
            display: flex;
            justify-content: space-between;
            gap: 20px;
            flex-wrap: wrap;
            margin-bottom: 40px;
        }

        figure {
            flex: 1;
            text-align: center;
            margin: 0;
            border: 1px solid #ddd;
            padding: 10px;
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            transition: box-shadow 0.3s ease;
        }

        figure:hover {
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
        }

        img {
            width: 100%;
            height: auto;
            border-radius: 8px;
        }

        figcaption {
            font-size: 0.9em;
            color: #666;
            margin-top: 10px;
        }

        @media (max-width: 768px) {
            .image-row {
                flex-direction: column;
                gap: 10px;
            }
        }
    </style>
</head>
<body>

    <div class="container">
        <h1>Siddharth Shashi: Project 3 - Face Morphing</h1>

        <h2>Description</h2>
        <p>
            The goal of this project is to produce a "morph" animation of my face into someone else's face, compute the mean of a population of 
            faces and extrapolate from a population mean to create a caricature of myself.
        </p>
        
        <h2>Core Approach</h2>
        <p>
            First, the image is split into three sections of equal height by splicing the image array. Then, using alignment functions, the 
            red and green channels are compared against the blue channel to compute ideal alignment offsets. Finally, the channels are shifted 
            according to their offsets, and then stacked on top of each other to create a single image. This process reduces visual artifacts 
            and ensures proper color alignment.
        </p>

        <h2>Mid-way Face</h2>
        <p>
            For images with lower resolutions, I implemented a search algorithm that computes the norm between the two channel image vectors
            at each displacement within a small window. The offset that results in the smallest norm is selected as the optimal alignment.
        </p>
        
        <div class="image-row">
            <figure>
                <img src="media/website/sidd.jpg" alt="sidd">
                <figcaption>picture of myself</figcaption>
            </figure>

            <figure>
                <img src="media/website/george_small.jpg" alt="george_small">
                <figcaption>picture of George Clooney</figcaption>
            </figure>

            <figure>
                <img src="media/website/sidd_george_mean.jpg" alt="sidd_george_mean">
                <figcaption>half me, half George Clooney</figcaption>
            </figure>
        </div>

        <h2>Morph Sequence</h2>
        <p>
            For higher-resolution images, I implemented a multi-scale pyramid search to make the process more efficient. Images are scaled 
            down, and alignment is first performed on the lower-resolution image. This alignment is then used as a starting point when 
            refining the alignment for the higher-resolution image.
        </p>

        <div class="image-row">
            <figure>
                <img src="media/website/animated.gif" alt="Morph Animation" width="500" height="auto">
                <figcaption>Morph Animation</figcaption>
            </figure>
        </div>

        <h2>The "Mean Face" of a Population</h2>
        <p>
            To improve alignment accuracy, especially for images where color intensities vary greatly, I applied edge detection using Sobel 
            filters. This method focuses on aligning the edges of the image features, which helps reduce misalignment caused by brightness 
            variations across channels.
        </p>

        <div class="image-row">
            <figure>
                <img src="media/website/average_neutral.jpg" alt="average_neutral">
                <figcaption>average neutral</figcaption>
            </figure>

            <figure>
                <img src="media/website/average_smile.jpg" alt="average_smile">
                <figcaption>average smiling</figcaption>
            </figure>
        </div>

        <div class="image-row">
            <figure>
                <img src="media/website/warped_sidd.jpg" alt="warped_sidd">
                <figcaption>myself warped into average geometry</figcaption>
            </figure>

            <figure>
                <img src="media/website/warped_neutral.jpg" alt="warped_neutral">
                <figcaption>the average warped into my geometry</figcaption>
            </figure>

            <figure>
                <img src="media/website/sidd_caricature.jpg" alt="sidd_caricature">
                <figcaption>caricature from extrapolation</figcaption>
            </figure>
        </div>

        <h2>Making Myself Italian</h2>
        <p>
            To improve alignment accuracy, especially for images where color intensities vary greatly, I applied edge detection using Sobel 
            filters. This method focuses on aligning the edges of the image features, which helps reduce misalignment caused by brightness 
            variations across channels.
        </p>

        <div class="image-row">
            <figure>
                <img src="media/website/sidd_italian_shape.jpg" alt="sidd_italian_shape">
                <figcaption>morphing just the shape</figcaption>
            </figure>

            <figure>
                <img src="media/website/sidd_italian_color.jpg" alt="sidd_italian_color">
                <figcaption>morphing just the color</figcaption>
            </figure>

            <figure>
                <img src="media/website/sidd_italian.jpg" alt="sidd_italian">
                <figcaption>morphing both the shape and color</figcaption>
            </figure>
        </div>
    </div>

</body>
</html>
